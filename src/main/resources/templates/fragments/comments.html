<!DOCTYPE html>
<html lang="en">
<html xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div th:fragment="comments(post)">
    <a th:text="#{comments}+'('+${post.comments.size()}+')'"
       class="btn btn-link"
       data-mdb-toggle="collapse"
       th:href="'#post'+${post.id}+'commentsDiv'"
       role="button"
       aria-expanded="false"
       aria-controls="collapseExample"
    ></a>
    <!-- Button Comment -->
    <div sec:authorize="isAuthenticated()" style="display: inline-block" class="w-50 text-center">
        <a class="btn btn-primary"
           th:text="#{Comment}"
           data-mdb-toggle="collapse"
           th:href="'#post'+${post.id}+'newCommentDiv'"
           role="button"
           aria-expanded="false"
           aria-controls="collapseExample"
        ></a>
    </div>
    <div sec:authorize="isAuthenticated()" th:id="'post'+${post.id}+'newCommentDiv'" class="collapse">
        <form th:action="'/posts/'+${post.id}+'/comments/new'" method="post">
            <div class="text-start mt-2 form-group flex-fill">
                <textarea class="form-control" name="commentBody" aria-label="With textarea" th:id="'inputComment'+${post.id}"></textarea>
                <button type="submit" class="btn btn-primary text-center m-2" th:text="#{Submit}"></button>
            </div>
        </form>

    </div>
    <!--Display all comments when click Comments() Button -->
    <div class="collapse mt-3" th:id="'post'+${post.id}+'commentsDiv'">
        <div th:each="comment: ${post.comments}"
             class="comment-content pt-2 pb-2 mb-2 rounded-5 shadow">
            <h4 class="mt-1 ms-3" th:text="${comment.user.username}+' :'"></h4>
            <p class="ms-3" th:text="${comment.body}" style="word-wrap:break-word"></p>
        </div>
        <p th:if="${post.comments.isEmpty()}" th:text="#{noComments}"></p>

</div>
</div>
</body>
</html>